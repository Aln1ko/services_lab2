# Базовий образ Python
FROM python:3.11-slim
# ↑ ↑ ↑
# Беремо офіційний образ Python з Docker Hub
# python:3.11-slim - легка версія (менше місца)

# Створюємо робочу директорію в контейнері
WORKDIR /app
# ↑ ↑ ↑  
# Всі команди будуть виконуватись в папці /app всередині контейнера

# Копіюємо requirements.txt для кешування
COPY ./auth_service/requirements.txt .
# ↑ ↑ ↑
# Копіюємо requirements.txt з твоєї папки в папку /app контейнера
# Це робиться окремо для оптимізації - Docker кешує цей крок

# Встановлюємо залежності Python
RUN pip install --no-cache-dir -r requirements.txt
# ↑ ↑ ↑
# --no-cache-dir - не зберігає кеш pip (економія місця)
# -r requirements.txt - встановлює всі бібліотеки з файлу

COPY shared ./shared

# Копіюємо весь код програми
COPY ./auth_service/ .
# ↑ ↑ ↑
# Копіюємо ВСІ файли з твоєї папки в /app контейнера


# Вказуємо порт, який буде використовувати додаток
EXPOSE 8000
# ↑ ↑ ↑
# Це ІНФОРМАЦІЙНА команда - каже "цей контейнер слухає порт 8000"
# Не відкриває порт автоматично!

# Команда запуску додатка
CMD ["uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "8000"]
# ↑ ↑ ↑
# Це команда яка виконається при запуску контейнера
# uvicorn - сервер
# app.main:app - шлях до твого додатка (файл app/main.py, змінна app)
# --host 0.0.0.0 - слухає всі мережеві інтерфейси
# --port 8000 - на порту 8000